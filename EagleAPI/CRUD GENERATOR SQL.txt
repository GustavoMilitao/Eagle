DECLARE @TABLENAME VARCHAR(100)
DECLARE @FIELDNAME VARCHAR(100)
DECLARE @SQL NVARCHAR(300)
DECLARE @SQLINSERT NVARCHAR(300)
DECLARE @SQLINSERTVALUES NVARCHAR(300)
DECLARE @SQLUPDATE NVARCHAR(300)
DECLARE @SQLDELETE NVARCHAR(300)

DECLARE CUR CURSOR FOR
  SELECT TABLE_NAME
 FROM INFORMATION_SCHEMA.COLUMNS
 GROUP BY TABLE_NAME

OPEN CUR

FETCH NEXT FROM CUR INTO @TABLENAME

WHILE @@FETCH_STATUS = 0
  BEGIN
      
	  DECLARE CUR1 CURSOR FOR
	  SELECT COLUMN_NAME
	  FROM INFORMATION_SCHEMA.COLUMNS
	  WHERE TABLE_NAME = @TABLENAME
	  set @SQLINSERT = 'INSERT INTO '+@TABLENAME +'('
	  set @SQLUPDATE = 'UPDATE '+@TABLENAME+' SET '
	  set @SQLDELETE = 'DELETE FROM '+@TABLENAME+CHAR(13)+CHAR(10)+ 'WHERE ID = @ID'
	  set @SQLINSERTVALUES = 'VALUES('
	  Set @SQL = 'SELECT '

	  OPEN CUR1

	  FETCH NEXT FROM CUR1 INTO @FIELDNAME

  WHILE @@FETCH_STATUS = 0
  BEGIN
  
  Set @SQL = @SQL + @FIELDNAME + ',' + CHAR(13)+CHAR(10)
  Set @SQLINSERT = @SQLINSERT + CHAR(13)+CHAR(10) + @FIELDNAME+',' 
  set @SQLINSERTVALUES = @SQLINSERTVALUES+ CHAR(13)+CHAR(10)+ '@'+ @FIELDNAME+',' 
  set @SQLUPDATE = 
  CASE WHEN @FIELDNAME <> 'ID' THEN
	@SQLUPDATE +CHAR(13)+CHAR(10)+ @FIELDNAME + ' = @'+@FIELDNAME+','
	ELSE @SQLUPDATE 
  END

  FETCH NEXT FROM CUR1 INTO @FIELDNAME
  END

  Set @SQL = @SQL + 'FROM '+ @TABLENAME + CHAR(13)+CHAR(10)
   +'WHERE ID = @ID '
  Set @SQLINSERT = LEFT(@SQLINSERT, NULLIF(LEN(@SQLINSERT)-1,-1))
  set @SQLINSERTVALUES = LEFT(@SQLINSERTVALUES, NULLIF(LEN(@SQLINSERTVALUES)-1,-1))
  Set @SQLINSERT = @SQLINSERT+')'+ CHAR(13)+CHAR(10)
  set @SQLINSERTVALUES = @SQLINSERTVALUES+')'
  set @SQLUPDATE = LEFT(@SQLUPDATE, NULLIF(LEN(@SQLUPDATE)-1,-1)) +CHAR(13)+CHAR(10)+'WHERE ID = @ID'

  CLOSE CUR1
  DEALLOCATE CUR1 

  print ' ---- ' + @TABLENAME + ' ---- '
  print ''
  print @SQL
  print ''
  print ''
  print @SQLINSERT + @SQLINSERTVALUES
  print ''
  print ''
  print @SQLUPDATE
  print ''
  print ''
  print @SQLDELETE
  print ''
  print ''

FETCH NEXT FROM CUR INTO @TABLENAME
  END

CLOSE CUR

DEALLOCATE CUR 






